(function(){"use strict";function I(e,v){let i="123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ",a=t=>[...t].reduce((n,s)=>n*i.length+i.indexOf(s)|0,0),b=e.hash.slice(2),O=new RegExp(".{"+(e.hash.length/4|0)+"}","g"),F=b.match(O).map(t=>a(t));const d=((t,n,s,_)=>()=>{t|=0,n|=0,s|=0,_|=0;var S=(t+n|0)+_|0;return _=_+1|0,t=n^n>>>9,n=s+(s<<3)|0,s=s<<21|s>>>11,s=s+S|0,(S>>>0)/4294967296})(...F),B=t=>Math.floor(t.length*d()),f=t=>t[B(t)],C=t=>Number((d()*2*t-1*t).toFixed(3)),l=(t,n)=>Number((d()*(n-t)+t).toFixed(3)),w=(t,n=0)=>Number((d()*t+n).toFixed(3)),o=(t,n)=>Array(t).fill(n),k=t=>t.split("-").map(n=>n.charAt(0).toUpperCase()+n.slice(1)).join(" "),D={black_white:[[0,0,0],[1,1,1]],black_red:[[0,0,0],[1,.141,.141]],black_blue:[[0,0,0],[.09,.259,1]]},z={black_red:"Crimison",black_blue:"Azure",black_white:"Ivory"},M=[...o(1,"black_red"),...o(1,"black_blue"),...o(1,"black_white")],m=f(M),W="normal",L=z[m]||m,H=[...o(40,"low"),...o(25,"medium"),...o(25,"high")],g=f(H);let h;switch(g){case"low":h={x:l(.2,.4),y:w(.2,.4)};break;case"medium":h={x:l(.4,.9),y:w(.4,.9)};break;case"high":h={x:l(1,1.6),y:w(1,1.6)};break}const G={perspective:["high-density"],high:[...o(50,"high-density"),...o(50,"medium-density")],medium:[...o(50,"high-density"),...o(40,"medium-density"),...o(10,"low-density")],low:["high-density"]}[g],E=f(G);let y;switch(E){case"high-density":y=l(80,140);break;case"medium-density":y=l(40,80);break;case"low-density":y=l(20,40);break}const X=f([2,4,8]),j={offset:{x:C(2560),y:C(2560)},palette:m,paletteName:L,paletteType:W,scaleType:g,scale:h,lineType:E,lines_density:y,octaves:X};return{Spectrum:L,"Dimensional Range":k(g),Pathways:k(E.split("-density")[0]),...v?{PARAMS:j,PALETTE:D[m],FXRAND:d}:{}}}var N=`#version 300 es
precision mediump float;in vec3 aPosition;out vec2 v_texcoord;void main(){v_texcoord=aPosition.xy;v_texcoord.y=1.0-v_texcoord.y;gl_Position=vec4(aPosition*2.0-1.0,1.0);}`,U=`#version 300 es
precision mediump float;out vec4 fragColor;uniform vec2 u_resolution;uniform vec2 noise_offset;uniform vec2 noise_scale;uniform float octaves;uniform float lines_density;uniform vec3 color_bg;uniform vec3 color_line;vec2 grad(ivec2 z){int n=z.x+z.y*11111;n=(n<<13)^n;n=(n*(n*n*15731+789221)+1376312589)>>16;n&=7;vec2 gr=vec2(n&1,n>>1)*2.0-1.0;return(n>=6)? vec2(0.0,gr.x):(n>=4)? vec2(gr.x,0.0):gr;}float noise(in vec2 p){ivec2 i=ivec2(floor(p));vec2 f=fract(p);vec2 u=f*f*(3.0-2.0*f);return mix(mix(dot(grad(i+ivec2(0,0)),f-vec2(0.0,0.0)),dot(grad(i+ivec2(1,0)),f-vec2(1.0,0.0)),u.x),mix(dot(grad(i+ivec2(0,1)),f-vec2(0.0,1.0)),dot(grad(i+ivec2(1,1)),f-vec2(1.0,1.0)),u.x),u.y);}float noise(vec3 p){return noise(p.xy);}float fnoise(vec2 uv){uv*=8.0;float f=0.0;const mat2 m=mat2(1.6,1.2,-1.2,1.6);f=0.5000*noise(uv);uv=m*uv;f+=0.2500*noise(uv);uv=m*uv;f+=0.1250*noise(uv);uv=m*uv;f+=0.0625*noise(uv);uv=m*uv;return f;}float norm_value(float value){return 0.5*value+0.5;}float nnoise(vec2 value){return norm_value(noise(value));}float nnoise(vec3 value){return norm_value(noise(value));}float calcTerrain(vec2 st){vec2 uv=st+noise_offset;float f=0.;mat2 m=mat2(1.6,1.2,-1.2,1.6);f=0.5000*noise(uv);uv=m*uv;if(octaves>1.)f+=0.2500*noise(uv);uv=m*uv;if(octaves>2.)f+=0.1250*noise(uv);uv=m*uv;if(octaves>3.)f+=0.0625*noise(uv);uv=m*uv;return norm_value(f);}void main(){vec2 st=gl_FragCoord.xy/u_resolution;float n_color=calcTerrain(st*noise_scale);vec3 color=color_bg;float numLines=lines_density;float linePos=fract(n_color*numLines);float lineWeight=4.0*numLines/min(u_resolution.x,u_resolution.y);if(linePos<lineWeight){color=color_line;}fragColor=vec4(color,1.0);}`;const u=I(tokenData,!0),{PARAMS:c,PALETTE:A,FXRAND:J}=u;delete u.PARAMS,delete u.PALETTE,delete u.FXRAND;const P=document.getElementById("debug--params"),R=document.getElementById("debug--traits");P&&R&&(R.innerText=JSON.stringify({FEATURES:u},null,2),P.innerText=JSON.stringify({PARAMS:c},null,2),window&&(window.PARAMS=c));const p=1488,x=2104;let r,T;p5.RendererGL.prototype._initContext=function(){try{if(this.drawingContext=this.canvas.getContext("webgl2",this._pInst._glAttributes)||this.canvas.getContext("experimental-webgl",this._pInst._glAttributes),this.drawingContext===null)throw new Error("Error creating webgl context");{const e=this.drawingContext;e.disable(e.DEPTH_TEST),e.viewport(0,0,e.drawingBufferWidth,e.drawingBufferHeight),this._viewport=this.drawingContext.getParameter(this.drawingContext.VIEWPORT)}}catch(e){throw e}},new window.p5(function(e){e.setup=function(){T=e.createCanvas(p,x,e.WEBGL),T.GL,e.pixelDensity(2),e.background(0),e.applyShader(),e.windowResized()},e.applyShader=function(){r=e.createShader(N,U),e.shader(r),r.setUniform("u_resolution",[p,x]),r.setUniform("octaves",c.octaves),r.setUniform("noise_offset",[c.offset.x,c.offset.y]),r.setUniform("noise_scale",[c.scale.x,c.scale.y]),r.setUniform("color_bg",A[0]),r.setUniform("color_line",A[1]),r.setUniform("lines_density",c.lines_density),e.quad(-1,-1,1,-1,1,1,-1,1)},e.windowResized=function(){const v=document.getElementById("debug--traits");let i=document.getElementById("defaultCanvas0");if(i&&!v){const a=document.body.clientWidth,b=document.body.clientHeight;a/b>p/x?(i.style.setProperty("width","auto","important"),i.style.setProperty("height","100%","important")):(i.style.setProperty("width","100%","important"),i.style.setProperty("height","auto","important"))}},e.keyPressed=function(){e.keyCode===68&&document.getElementById("defaultCanvas0").toBlob(i=>{const a=document.createElement("a");a.href=URL.createObjectURL(i),a.download=`${tokenData.hash}.png`,document.body.appendChild(a),a.click(),document.body.removeChild(a)},"image/png")}},"canvas")})();
